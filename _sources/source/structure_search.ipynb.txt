{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "8d7cb2ed-a704-4b35-aa29-6996a9e80272",
   "metadata": {},
   "source": [
    "# Structure search"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "69985863-21be-43fb-90fb-7c79a58c188b",
   "metadata": {},
   "source": [
    "NIST Chemistry WebBook supports structure search, however to the best of our knowledge there is no straightforward way to implement it as a Python API. To overcome this problem, as well as WebBook's limitation of found compounds, **NistChemPy** package contains dataframe with the main info on all NIST Chemistry WebBook compounds:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "6d78af72-40e0-4f28-b615-0d5bb1be52cc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>name</th>\n",
       "      <th>formula</th>\n",
       "      <th>mol_weight</th>\n",
       "      <th>inchi</th>\n",
       "      <th>inchi_key</th>\n",
       "      <th>cas_rn</th>\n",
       "      <th>mol2D</th>\n",
       "      <th>mol3D</th>\n",
       "      <th>cIR</th>\n",
       "      <th>...</th>\n",
       "      <th>cGC</th>\n",
       "      <th>cTG</th>\n",
       "      <th>cTC</th>\n",
       "      <th>cTP</th>\n",
       "      <th>cSO</th>\n",
       "      <th>cTR</th>\n",
       "      <th>cIE</th>\n",
       "      <th>cIC</th>\n",
       "      <th>cES</th>\n",
       "      <th>cDI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>B100</td>\n",
       "      <td>iron oxide anion</td>\n",
       "      <td>FeO-</td>\n",
       "      <td>71.8450</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>B1000</td>\n",
       "      <td>AsF3..Cl anion</td>\n",
       "      <td>AsClF3-</td>\n",
       "      <td>167.3700</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>B1000000</td>\n",
       "      <td>AgH2-</td>\n",
       "      <td>AgH2-</td>\n",
       "      <td>109.8846</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>B1000001</td>\n",
       "      <td>HAg(H2)</td>\n",
       "      <td>AgH3</td>\n",
       "      <td>110.8920</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>B1000002</td>\n",
       "      <td>AgNO+</td>\n",
       "      <td>AgNO+</td>\n",
       "      <td>137.8738</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129000</th>\n",
       "      <td>U99777</td>\n",
       "      <td>Methyl 3-hydroxycholest-5-en-26-oate, TMS deri...</td>\n",
       "      <td>C31 H54 O3 Si</td>\n",
       "      <td>502.8442</td>\n",
       "      <td>InChI=1S/C31H54O3Si/c1-21(10-9-11-22(2)29(32)3...</td>\n",
       "      <td>DNXGNXYNSBCWGX-QBUYVTDMSA-N</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129001</th>\n",
       "      <td>U99830</td>\n",
       "      <td>2-Methyl-3-oxovaleric acid, O,O'-bis(trimethyl...</td>\n",
       "      <td>C12 H26 O3 Si2</td>\n",
       "      <td>274.5040</td>\n",
       "      <td>InChI=1S/C12H26O3Si2/c1-9-11(14-16(3,4)5)10(2)...</td>\n",
       "      <td>LXAIQDVPXKOIGO-KHPPLWFESA-N</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129002</th>\n",
       "      <td>U99942</td>\n",
       "      <td>3-Hydroxy-3-(4'-hydroxy-3'-methoxyphenyl)propi...</td>\n",
       "      <td>C19 H36 O5 Si3</td>\n",
       "      <td>428.7426</td>\n",
       "      <td>InChI=1S/C19H36O5Si3/c1-21-18-13-15(11-12-16(1...</td>\n",
       "      <td>QCMUGKOFXVYNCF-UHFFFAOYSA-N</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129003</th>\n",
       "      <td>U99947</td>\n",
       "      <td>2-Propylpentanoic acid, 2,3,4,6-tetra(trimethy...</td>\n",
       "      <td>C26 H58 O7 Si4</td>\n",
       "      <td>595.0765</td>\n",
       "      <td>InChI=1S/C26H58O7Si4/c1-15-17-20(18-16-2)25(27...</td>\n",
       "      <td>OVXMRISJDUWFKB-UHFFFAOYSA-N</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>129004</th>\n",
       "      <td>x</td>\n",
       "      <td>Y5O2 radical</td>\n",
       "      <td>O2 Y5</td>\n",
       "      <td>476.5281</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>&lt;NA&gt;</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>129005 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "              ID                                               name  \\\n",
       "0           B100                                   iron oxide anion   \n",
       "1          B1000                                     AsF3..Cl anion   \n",
       "2       B1000000                                              AgH2-   \n",
       "3       B1000001                                            HAg(H2)   \n",
       "4       B1000002                                              AgNO+   \n",
       "...          ...                                                ...   \n",
       "129000    U99777  Methyl 3-hydroxycholest-5-en-26-oate, TMS deri...   \n",
       "129001    U99830  2-Methyl-3-oxovaleric acid, O,O'-bis(trimethyl...   \n",
       "129002    U99942  3-Hydroxy-3-(4'-hydroxy-3'-methoxyphenyl)propi...   \n",
       "129003    U99947  2-Propylpentanoic acid, 2,3,4,6-tetra(trimethy...   \n",
       "129004         x                                       Y5O2 radical   \n",
       "\n",
       "               formula  mol_weight  \\\n",
       "0                 FeO-     71.8450   \n",
       "1              AsClF3-    167.3700   \n",
       "2                AgH2-    109.8846   \n",
       "3                 AgH3    110.8920   \n",
       "4                AgNO+    137.8738   \n",
       "...                ...         ...   \n",
       "129000   C31 H54 O3 Si    502.8442   \n",
       "129001  C12 H26 O3 Si2    274.5040   \n",
       "129002  C19 H36 O5 Si3    428.7426   \n",
       "129003  C26 H58 O7 Si4    595.0765   \n",
       "129004           O2 Y5    476.5281   \n",
       "\n",
       "                                                    inchi  \\\n",
       "0                                                    <NA>   \n",
       "1                                                    <NA>   \n",
       "2                                                    <NA>   \n",
       "3                                                    <NA>   \n",
       "4                                                    <NA>   \n",
       "...                                                   ...   \n",
       "129000  InChI=1S/C31H54O3Si/c1-21(10-9-11-22(2)29(32)3...   \n",
       "129001  InChI=1S/C12H26O3Si2/c1-9-11(14-16(3,4)5)10(2)...   \n",
       "129002  InChI=1S/C19H36O5Si3/c1-21-18-13-15(11-12-16(1...   \n",
       "129003  InChI=1S/C26H58O7Si4/c1-15-17-20(18-16-2)25(27...   \n",
       "129004                                               <NA>   \n",
       "\n",
       "                          inchi_key cas_rn  mol2D  mol3D    cIR  ...    cGC  \\\n",
       "0                              <NA>   <NA>  False  False  False  ...  False   \n",
       "1                              <NA>   <NA>  False  False  False  ...  False   \n",
       "2                              <NA>   <NA>  False  False  False  ...  False   \n",
       "3                              <NA>   <NA>  False  False  False  ...  False   \n",
       "4                              <NA>   <NA>  False  False  False  ...  False   \n",
       "...                             ...    ...    ...    ...    ...  ...    ...   \n",
       "129000  DNXGNXYNSBCWGX-QBUYVTDMSA-N   <NA>   True  False  False  ...   True   \n",
       "129001  LXAIQDVPXKOIGO-KHPPLWFESA-N   <NA>   True  False  False  ...   True   \n",
       "129002  QCMUGKOFXVYNCF-UHFFFAOYSA-N   <NA>   True  False  False  ...   True   \n",
       "129003  OVXMRISJDUWFKB-UHFFFAOYSA-N   <NA>   True  False  False  ...   True   \n",
       "129004                         <NA>   <NA>  False  False  False  ...  False   \n",
       "\n",
       "          cTG    cTC    cTP    cSO    cTR    cIE    cIC    cES    cDI  \n",
       "0        True  False  False  False   True   True  False  False  False  \n",
       "1        True  False  False  False  False  False  False  False  False  \n",
       "2       False  False  False  False  False  False  False   True  False  \n",
       "3       False  False  False  False  False  False  False   True  False  \n",
       "4       False  False  False  False  False  False  False   True  False  \n",
       "...       ...    ...    ...    ...    ...    ...    ...    ...    ...  \n",
       "129000  False  False  False  False  False  False  False  False  False  \n",
       "129001  False  False  False  False  False  False  False  False  False  \n",
       "129002  False  False  False  False  False  False  False  False  False  \n",
       "129003  False  False  False  False  False  False  False  False  False  \n",
       "129004  False  False  False  False  False   True  False  False  False  \n",
       "\n",
       "[129005 rows x 23 columns]"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import nistchempy as nist\n",
    "\n",
    "df = nist.get_all_data()\n",
    "df"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cbfd6766-a8bb-4817-8df4-e7680beceb7a",
   "metadata": {},
   "source": [
    "First of all, this dataframe can be used to limit all entries to those ones with desired properties:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "c8912156-a244-45de-bc29-0b832a080806",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ID</th>\n",
       "      <th>name</th>\n",
       "      <th>formula</th>\n",
       "      <th>mol_weight</th>\n",
       "      <th>inchi</th>\n",
       "      <th>inchi_key</th>\n",
       "      <th>cas_rn</th>\n",
       "      <th>mol2D</th>\n",
       "      <th>mol3D</th>\n",
       "      <th>cIR</th>\n",
       "      <th>...</th>\n",
       "      <th>cGC</th>\n",
       "      <th>cTG</th>\n",
       "      <th>cTC</th>\n",
       "      <th>cTP</th>\n",
       "      <th>cSO</th>\n",
       "      <th>cTR</th>\n",
       "      <th>cIE</th>\n",
       "      <th>cIC</th>\n",
       "      <th>cES</th>\n",
       "      <th>cDI</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>11398</th>\n",
       "      <td>C100016</td>\n",
       "      <td>p-Nitroaniline</td>\n",
       "      <td>C6 H6 N2 O2</td>\n",
       "      <td>138.1240</td>\n",
       "      <td>InChI=1S/C6H6N2O2/c7-5-1-3-6(4-2-5)8(9)10/h1-4...</td>\n",
       "      <td>TYMLOMAKGOJONV-UHFFFAOYSA-N</td>\n",
       "      <td>100-01-6</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11399</th>\n",
       "      <td>C100027</td>\n",
       "      <td>Phenol, 4-nitro-</td>\n",
       "      <td>C6 H5 NO3</td>\n",
       "      <td>139.1088</td>\n",
       "      <td>InChI=1S/C6H5NO3/c8-6-3-1-5(2-4-6)7(9)10/h1-4,8H</td>\n",
       "      <td>BTJIUGUIPKRLHP-UHFFFAOYSA-N</td>\n",
       "      <td>100-02-7</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11418</th>\n",
       "      <td>C100094</td>\n",
       "      <td>Benzoic acid, 4-methoxy-</td>\n",
       "      <td>C8 H8 O3</td>\n",
       "      <td>152.1473</td>\n",
       "      <td>InChI=1S/C8H8O3/c1-11-7-4-2-6(3-5-7)8(9)10/h2-...</td>\n",
       "      <td>ZEYHEAKUIGZSGI-UHFFFAOYSA-N</td>\n",
       "      <td>100-09-4</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11423</th>\n",
       "      <td>C100107</td>\n",
       "      <td>Benzaldehyde, 4-(dimethylamino)-</td>\n",
       "      <td>C9 H11 NO</td>\n",
       "      <td>149.1897</td>\n",
       "      <td>InChI=1S/C9H11NO/c1-10(2)9-5-3-8(7-11)4-6-9/h3...</td>\n",
       "      <td>BGNGWHSBYQYVRX-UHFFFAOYSA-N</td>\n",
       "      <td>100-10-7</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11428</th>\n",
       "      <td>C100129</td>\n",
       "      <td>Benzene, 1-ethyl-4-nitro-</td>\n",
       "      <td>C8 H9 NO2</td>\n",
       "      <td>151.1626</td>\n",
       "      <td>InChI=1S/C8H9NO2/c1-2-7-3-5-8(6-4-7)9(10)11/h3...</td>\n",
       "      <td>RESTWAHJFMZUIZ-UHFFFAOYSA-N</td>\n",
       "      <td>100-12-9</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65988</th>\n",
       "      <td>C99934</td>\n",
       "      <td>Acetophenone, 4'-hydroxy-</td>\n",
       "      <td>C8 H8 O2</td>\n",
       "      <td>136.1479</td>\n",
       "      <td>InChI=1S/C8H8O2/c1-6(9)7-2-4-8(10)5-3-7/h2-5,1...</td>\n",
       "      <td>TXFPEBPIARQUIG-UHFFFAOYSA-N</td>\n",
       "      <td>99-93-4</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65991</th>\n",
       "      <td>C99945</td>\n",
       "      <td>Benzoic acid, 4-methyl-</td>\n",
       "      <td>C8 H8 O2</td>\n",
       "      <td>136.1479</td>\n",
       "      <td>InChI=1S/C8H8O2/c1-6-2-4-7(5-3-6)8(9)10/h2-5H,...</td>\n",
       "      <td>LPNBBFKOUUSUDB-UHFFFAOYSA-N</td>\n",
       "      <td>99-94-5</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>65998</th>\n",
       "      <td>C99967</td>\n",
       "      <td>Benzoic acid, 4-hydroxy-</td>\n",
       "      <td>C7 H6 O3</td>\n",
       "      <td>138.1207</td>\n",
       "      <td>InChI=1S/C7H6O3/c8-6-3-1-5(2-4-6)7(9)10/h1-4,8...</td>\n",
       "      <td>FJKROLUGYXJWQN-UHFFFAOYSA-N</td>\n",
       "      <td>99-96-7</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66003</th>\n",
       "      <td>C99978</td>\n",
       "      <td>Benzenamine, N,N,4-trimethyl-</td>\n",
       "      <td>C9 H13 N</td>\n",
       "      <td>135.2062</td>\n",
       "      <td>InChI=1S/C9H13N/c1-8-4-6-9(7-5-8)10(2)3/h4-7H,...</td>\n",
       "      <td>GYVGXEWAOAAJEU-UHFFFAOYSA-N</td>\n",
       "      <td>99-97-8</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>66011</th>\n",
       "      <td>C99990</td>\n",
       "      <td>Benzene, 1-methyl-4-nitro-</td>\n",
       "      <td>C7 H7 NO2</td>\n",
       "      <td>137.1360</td>\n",
       "      <td>InChI=1S/C7H7NO2/c1-6-2-4-7(5-3-6)8(9)10/h2-5H...</td>\n",
       "      <td>ZPTVNYMJQHSSEA-UHFFFAOYSA-N</td>\n",
       "      <td>99-99-0</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>...</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>True</td>\n",
       "      <td>False</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1555 rows × 23 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            ID                              name      formula  mol_weight  \\\n",
       "11398  C100016                    p-Nitroaniline  C6 H6 N2 O2    138.1240   \n",
       "11399  C100027                  Phenol, 4-nitro-    C6 H5 NO3    139.1088   \n",
       "11418  C100094          Benzoic acid, 4-methoxy-     C8 H8 O3    152.1473   \n",
       "11423  C100107  Benzaldehyde, 4-(dimethylamino)-    C9 H11 NO    149.1897   \n",
       "11428  C100129         Benzene, 1-ethyl-4-nitro-    C8 H9 NO2    151.1626   \n",
       "...        ...                               ...          ...         ...   \n",
       "65988   C99934         Acetophenone, 4'-hydroxy-     C8 H8 O2    136.1479   \n",
       "65991   C99945           Benzoic acid, 4-methyl-     C8 H8 O2    136.1479   \n",
       "65998   C99967          Benzoic acid, 4-hydroxy-     C7 H6 O3    138.1207   \n",
       "66003   C99978     Benzenamine, N,N,4-trimethyl-     C9 H13 N    135.2062   \n",
       "66011   C99990        Benzene, 1-methyl-4-nitro-    C7 H7 NO2    137.1360   \n",
       "\n",
       "                                                   inchi  \\\n",
       "11398  InChI=1S/C6H6N2O2/c7-5-1-3-6(4-2-5)8(9)10/h1-4...   \n",
       "11399   InChI=1S/C6H5NO3/c8-6-3-1-5(2-4-6)7(9)10/h1-4,8H   \n",
       "11418  InChI=1S/C8H8O3/c1-11-7-4-2-6(3-5-7)8(9)10/h2-...   \n",
       "11423  InChI=1S/C9H11NO/c1-10(2)9-5-3-8(7-11)4-6-9/h3...   \n",
       "11428  InChI=1S/C8H9NO2/c1-2-7-3-5-8(6-4-7)9(10)11/h3...   \n",
       "...                                                  ...   \n",
       "65988  InChI=1S/C8H8O2/c1-6(9)7-2-4-8(10)5-3-7/h2-5,1...   \n",
       "65991  InChI=1S/C8H8O2/c1-6-2-4-7(5-3-6)8(9)10/h2-5H,...   \n",
       "65998  InChI=1S/C7H6O3/c8-6-3-1-5(2-4-6)7(9)10/h1-4,8...   \n",
       "66003  InChI=1S/C9H13N/c1-8-4-6-9(7-5-8)10(2)3/h4-7H,...   \n",
       "66011  InChI=1S/C7H7NO2/c1-6-2-4-7(5-3-6)8(9)10/h2-5H...   \n",
       "\n",
       "                         inchi_key    cas_rn  mol2D  mol3D    cIR  ...   cGC  \\\n",
       "11398  TYMLOMAKGOJONV-UHFFFAOYSA-N  100-01-6   True   True   True  ...  True   \n",
       "11399  BTJIUGUIPKRLHP-UHFFFAOYSA-N  100-02-7   True   True   True  ...  True   \n",
       "11418  ZEYHEAKUIGZSGI-UHFFFAOYSA-N  100-09-4   True   True  False  ...  True   \n",
       "11423  BGNGWHSBYQYVRX-UHFFFAOYSA-N  100-10-7   True   True   True  ...  True   \n",
       "11428  RESTWAHJFMZUIZ-UHFFFAOYSA-N  100-12-9   True   True   True  ...  True   \n",
       "...                            ...       ...    ...    ...    ...  ...   ...   \n",
       "65988  TXFPEBPIARQUIG-UHFFFAOYSA-N   99-93-4   True   True   True  ...  True   \n",
       "65991  LPNBBFKOUUSUDB-UHFFFAOYSA-N   99-94-5   True   True   True  ...  True   \n",
       "65998  FJKROLUGYXJWQN-UHFFFAOYSA-N   99-96-7   True   True   True  ...  True   \n",
       "66003  GYVGXEWAOAAJEU-UHFFFAOYSA-N   99-97-8   True   True   True  ...  True   \n",
       "66011  ZPTVNYMJQHSSEA-UHFFFAOYSA-N   99-99-0   True   True   True  ...  True   \n",
       "\n",
       "         cTG   cTC   cTP    cSO    cTR   cIE    cIC    cES    cDI  \n",
       "11398   True  True  True  False   True  True  False  False  False  \n",
       "11399   True  True  True   True   True  True   True  False  False  \n",
       "11418   True  True  True  False   True  True  False  False  False  \n",
       "11423  False  True  True  False  False  True  False  False  False  \n",
       "11428  False  True  True  False  False  True  False  False  False  \n",
       "...      ...   ...   ...    ...    ...   ...    ...    ...    ...  \n",
       "65988  False  True  True  False   True  True   True  False  False  \n",
       "65991   True  True  True  False   True  True  False  False  False  \n",
       "65998   True  True  True  False   True  True  False  False  False  \n",
       "66003   True  True  True  False   True  True   True  False  False  \n",
       "66011   True  True  True   True   True  True   True  False  False  \n",
       "\n",
       "[1555 rows x 23 columns]"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sub = df.loc[~df.inchi.isna() & df.mol2D & df.cMS & df.cUV]\n",
    "sub"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "32a852f5-190c-4ad6-897f-3a0bd11b29f1",
   "metadata": {},
   "source": [
    "Next, we can run a substructure search, e.g. to get only non-aromatic compounds:"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "4e92f88d-c88c-4703-8a38-b4d079f7654a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "338 of 1555 compounds were selected\n"
     ]
    }
   ],
   "source": [
    "from rdkit import Chem\n",
    "\n",
    "# supress rdkit warnings\n",
    "from rdkit import RDLogger\n",
    "RDLogger.DisableLog('rdApp.*')\n",
    "\n",
    "# prepare molecules for search\n",
    "mols = [(ID, Chem.MolFromInchi(inchi)) for ID, inchi in zip(sub.ID, sub.inchi)]\n",
    "mols = [(ID, mol) for ID, mol in mols if mol]\n",
    "\n",
    "# search\n",
    "pat = Chem.MolFromSmarts('[a]')\n",
    "hits = [ID for ID, mol in mols if not mol.HasSubstructMatch(pat)]\n",
    "print(f'{len(hits)} of {len(sub)} compounds were selected')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0b0c6c3d-0887-472c-94ee-2cb161aecb3f",
   "metadata": {},
   "source": [
    "Those compounds can be retrieved via `nist.get_compound` function."
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.14"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
